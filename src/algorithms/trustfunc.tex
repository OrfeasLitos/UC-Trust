\Suppressnumber
\begin{lstlisting}[label=trustfunc, style=numbers]
(*@$\mathcal{F}_{\mathrm{Trust}}$ \Reactivatenumber@*)
Has oracle access to every player's (*@$Alice$@*) utility function (*@$U_{Alice}$@*)

Upon receiving (chooseBestSeller, (*@$d$@*), (*@$L$@*)) from (*@$Alice$@*) at time t:
  (*@$\mathtt{m}_{\mathrm{Alice}}$@*) = (*@$\mathcal{G}_{\mathrm{Ledger}}$@*).money((*@$Alice$@*))
  (*@$\mathtt{a}_{\mathrm{Alice}}$@*) = (*@$\mathcal{G}_{\mathrm{Assets}}$@*).assets((*@$Alice$@*))
  (*@$\mathtt{m}_{\mathrm{Bob}}$@*) = (*@$\mathcal{G}_{\mathrm{Ledger}}$@*).money((*@$Bob$@*))
  (*@$\mathtt{a}_{\mathrm{Bob}}$@*) = (*@$\mathcal{G}_{\mathrm{Assets}}$@*).assets((*@$Bob$@*))
  (*@$Bob$@*) = (*@$\argmax\limits_{Bob \in L}\left\{\right. U_{Alice}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Alice}} - x, \mathtt{a}_{\mathrm{Alice}} \cup \left\{\mathtt{s}\right\}\right):$@*)
  (*@$\mathtt{s} \in \mathtt{d} \cap \mathtt{a}_{\mathrm{Bob}} \wedge \mathtt{m}_{\mathrm{Alice}} \geq \mathtt{x} \wedge$@*)
  (*@$U_{Alice}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Alice}} - \mathtt{x}, \mathtt{a}_{\mathrm{Alice}} \cup \left\{\mathtt{s}\right\}\right) > U_{Alice}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Alice}}, \mathtt{a}_{\mathrm{Alice}}\right) \wedge$@*)
  (*@$U_{Bob}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Bob}} + x, \mathtt{a}_{\mathrm{Bob}} \setminus \left\{\mathtt{s}\right\}\right) > U_{Bob}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Bob}}, \mathtt{a}_{\mathrm{Bob}}\right) \wedge$@*)
  (*@$U_{Bob}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Bob}} + x, \mathtt{a}_{\mathrm{Bob}}\right) < U_{Bob}\left(\mathtt{t}, \mathtt{m}_{\mathrm{Bob}}, \mathtt{a}_{\mathrm{Bob}}\right) \left.\right\}$@*) # impossible
  send message (bestSeller, d, L, (*@$Bob$@*)) to (*@$Alice$@*)
\end{lstlisting}

Assumptions:
\begin{itemize}
  \item Trades are atomic. $\mathcal{F}_{\mathrm{Trust}}$ can deterministically decide whether
  $Bob$ will complete the trade.
  \item The internal workings of $\mathcal{F}_{\mathrm{Trust}}$ is common knowledge to the players.
  Their utility depends on it.
\end{itemize}
Note: It would be interesting to see how utilities (as algorithms) and
$\mathcal{F}_{\mathrm{Trust}}$ have a "fixed point".
