\Suppressnumber
\begin{lstlisting}[label=satfunc, style=numbers]
(*@$\mathcal{F}_{SAT}$ \Reactivatenumber@*)
Initialization:
allSet = False
for all (*@$Alice \in \mathcal{P}$@*)
  set((*@$Alice$@*)) = False

Upon receiving input set(tokens, map(desire => price)) from (*@$Alice$@*):
  If set((*@$Alice$@*)) == False
    set((*@$Alice$@*)) = True
    tokens[(*@$Alice$@*)] = tokens
    prices[(*@$Alice$@*)] = map
    If (*@$\nexists Bob \in \mathcal{P}:$@*) set((*@$Bob$@*)) == False
      allSet = True

Upon receiving message cost((*@$Bob$@*), desire) from (*@$Alice$@*):
  If allSet == True
    send message prices[(*@$Bob$@*)](desire) to (*@$Alice$@*)

Upon receiving message sat(desire) from (*@$Bob$@*):
  If allSet == True
    Choose whether to satisfy this desire and with whose tokens based on a utility function to be defined
    If the desire is satisfied
      send message (*@$s$@*)(desire, (*@$Bob$@*)) to (*@$Bob$@*)

transfer((*@$Alice$@*), (*@$Bob$@*), tokens):
  If allSet == True
    If tokens[(*@$Alice$@*)] >= tokens
      tokens[(*@$Alice$@*)] = tokens[(*@$Alice$@*)] - tokens
      tokens[(*@$Bob$@*)] = tokens[(*@$Bob$@*)] + tokens
\end{lstlisting}
